# Carbon6 OiS Installer - Part 3 of 4: Post-Installation Configuration

```
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•     â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘        â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—
â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘        â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘
â–ˆâ–ˆâ•‘     â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
â•šâ•â•      â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•   â•šâ•â•â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•â•â•šâ•â•     â•šâ•â• â•šâ•â•â•â•â•â•
```

**Classification:** L5-BLACK Strategic Configuration
**Agent:** SOVEREIGN (Strategic Command)
**Phase:** Post-Installation Configuration (3 of 4)
**Duration:** 10-15 minutes

---

## Introduction

```
ğŸ‘¤ SOVEREIGN: "Greetings. I am SOVEREIGN, Strategic Command of the Council.
The infrastructure is built, services are running - now we configure for
operational excellence.

Think of me as your Chief Strategy Officer. I ensure governance, security,
and long-term sustainability. This phase transforms your raw installation
into a production-ready, enterprise-grade Operational Intelligence System.

We'll create your admin account, onboard your first creator, test the Council
agents, configure the 88xâ„¢ trading system, and harden production security.

Every configuration I make follows the VLTRN sovereignty principles: security
first, privacy by design, and operational excellence."
```

**What This Part Does:**
- âœ… Create admin user account (L5-BLACK clearance)
- âœ… Configure first Creator (Carbon tier)
- âœ… Set up plugin marketplace
- âœ… Test Council agent orchestration
- âœ… Initialize 88xâ„¢ Chairman Console
- âœ… Configure monitoring dashboards
- âœ… Set up automated backups
- âœ… Production security hardening
- âœ… Create operational runbooks

**Estimated Time:** 10-15 minutes

---

## Phase 1: Admin Account Creation

```
ğŸ‘¤ SOVEREIGN: "First, we establish the supreme authority - your admin account
with L5-BLACK clearance. This account controls the entire Carbon6 OiS."

ğŸ”„ EXECUTING: Admin account creation
```

### 1.1 Interactive Admin Setup

```bash
#!/bin/bash

echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ADMIN ACCOUNT CREATION"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# Prompt for admin details
read -p "Admin Email: " admin_email
read -p "Admin Full Name: " admin_name
read -sp "Admin Password (min 12 characters): " admin_password
echo ""
read -sp "Confirm Password: " admin_password_confirm
echo ""

# Validate password match
if [ "$admin_password" != "$admin_password_confirm" ]; then
  echo "âœ— Passwords do not match. Exiting."
  exit 1
fi

# Validate password strength
if [ ${#admin_password} -lt 12 ]; then
  echo "âœ— Password must be at least 12 characters. Exiting."
  exit 1
fi

echo ""
echo "Creating admin account..."
```

### 1.2 Create Admin in Database

```typescript
// scripts/create-admin.ts
import { PrismaClient } from '@prisma/client';
import * as bcrypt from 'bcrypt';

const prisma = new PrismaClient();

async function createAdmin() {
  const email = process.env.ADMIN_EMAIL;
  const name = process.env.ADMIN_NAME;
  const password = process.env.ADMIN_PASSWORD;

  // Hash password
  const passwordHash = await bcrypt.hash(password, 12);

  // Create admin user
  const admin = await prisma.user.create({
    data: {
      email,
      name,
      passwordHash,
      role: 'ADMIN',
      clearance: 'L5-BLACK',
      status: 'ACTIVE',
      emailVerified: true,
      createdAt: new Date(),
      updatedAt: new Date(),
    },
  });

  console.log('âœ“ Admin account created:');
  console.log(`  ID: ${admin.id}`);
  console.log(`  Email: ${admin.email}`);
  console.log(`  Clearance: ${admin.clearance}`);
  console.log(`  Role: ${admin.role}`);

  return admin;
}

createAdmin()
  .then(() => prisma.$disconnect())
  .catch((error) => {
    console.error('âœ— Admin creation failed:', error);
    prisma.$disconnect();
    process.exit(1);
  });
```

**Execute:**
```bash
ADMIN_EMAIL="$admin_email" \
ADMIN_NAME="$admin_name" \
ADMIN_PASSWORD="$admin_password" \
npx ts-node scripts/create-admin.ts
```

**Expected Output:**
```
âœ“ Admin account created:
  ID: usr_admin_001
  Email: morpheous@vltrn.agency
  Clearance: L5-BLACK
  Role: ADMIN

âœ… ADMIN ACCOUNT CREATED
```

### 1.3 Generate Admin API Key

```bash
echo ""
echo "Generating admin API key..."

# Generate secure API key
admin_api_key=$(openssl rand -base64 48)

# Save to database
psql $DATABASE_URL << EOF
INSERT INTO api_keys (
  user_id,
  key_hash,
  name,
  clearance,
  permissions,
  expires_at,
  created_at
) VALUES (
  (SELECT id FROM users WHERE email = '$admin_email'),
  '$(echo -n $admin_api_key | sha256sum | cut -d' ' -f1)',
  'Admin Master Key',
  'L5-BLACK',
  '["*"]',
  NOW() + INTERVAL '10 years',
  NOW()
);
EOF

# Save API key securely
mkdir -p ~/.carbon6/keys
echo "$admin_api_key" > ~/.carbon6/keys/admin_api_key.txt
chmod 600 ~/.carbon6/keys/admin_api_key.txt

echo "âœ“ Admin API key generated and saved securely"
echo "  Location: ~/.carbon6/keys/admin_api_key.txt"
echo ""
echo "âš ï¸  IMPORTANT: This key grants full access to Carbon6 OiS."
echo "   Keep it secure and never commit it to version control."
```

---

## Phase 2: First Creator Onboarding

```
ğŸ‘¤ SOVEREIGN: "Now we'll create your first Creator account at the Carbon tier.
This demonstrates the three-tier system: Carbon â†’ Carbon[6] â†’ [6]."

ğŸ”„ EXECUTING: Creator onboarding
```

### 2.1 Create First Creator

```bash
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "FIRST CREATOR ONBOARDING"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

read -p "Creator Email: " creator_email
read -p "Creator Name: " creator_name
read -p "Creator Specialization (e.g., Full-Stack Developer): " creator_spec

echo ""
echo "Creating Carbon tier creator..."
```

**Database Script:**
```typescript
// scripts/create-creator.ts
import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

async function createCreator() {
  const creator = await prisma.creator.create({
    data: {
      email: process.env.CREATOR_EMAIL!,
      name: process.env.CREATOR_NAME!,
      tier: 'CARBON',
      specialization: process.env.CREATOR_SPEC!,
      revenueSplit: 50,
      status: 'ACTIVE',
      connectorEnabled: true,
      connectorRateLimit: 1000,
      joinedAt: new Date(),
    },
  });

  console.log('âœ“ Creator account created:');
  console.log(`  ID: ${creator.id}`);
  console.log(`  Email: ${creator.email}`);
  console.log(`  Tier: ${creator.tier} (50/50 split)`);
  console.log(`  Specialization: ${creator.specialization}`);

  return creator;
}

createCreator()
  .then(() => prisma.$disconnect())
  .catch((error) => {
    console.error('âœ— Creator creation failed:', error);
    prisma.$disconnect();
    process.exit(1);
  });
```

**Execute:**
```bash
CREATOR_EMAIL="$creator_email" \
CREATOR_NAME="$creator_name" \
CREATOR_SPEC="$creator_spec" \
npx ts-node scripts/create-creator.ts
```

**Expected Output:**
```
âœ“ Creator account created:
  ID: crt_carbon_001
  Email: dev@carbon6.io
  Tier: CARBON (50/50 split)
  Specialization: Full-Stack Developer

âœ… FIRST CREATOR ONBOARDED
```

### 2.2 Generate Creator SDK Installation

```bash
echo ""
echo "Generating SDK connector installation for creator..."

# Create connector installation
creator_installation_id="inst_$(openssl rand -hex 8)"
creator_client_id="client_$(openssl rand -hex 8)"

# Generate Ed25519 keypair for creator
ssh-keygen -t ed25519 -f ~/.carbon6/keys/creator_$creator_installation_id -N "" -C "creator-sdk"

creator_public_key=$(cat ~/.carbon6/keys/creator_$creator_installation_id.pub | base64)
creator_private_key=$(cat ~/.carbon6/keys/creator_$creator_installation_id | base64)

# Insert into database
psql $DATABASE_URL << EOF
INSERT INTO connector_installations (
  id,
  client_id,
  name,
  platform,
  public_key,
  private_key_fingerprint,
  creator_id,
  environment,
  features,
  rate_limits,
  enabled,
  created_at
) VALUES (
  '$creator_installation_id',
  '$creator_client_id',
  'Creator SDK - $creator_name',
  'nodejs',
  '$creator_public_key',
  '$(ssh-keygen -lf ~/.carbon6/keys/creator_$creator_installation_id.pub | awk '{print $2}')',
  (SELECT id FROM creators WHERE email = '$creator_email'),
  'production',
  '{"basic_api": true, "analytics_access": true, "terminal_access": true}',
  '{"api_calls_per_hour": 1000}',
  1,
  NOW()
);
EOF

echo "âœ“ SDK connector installation created"
echo "  Installation ID: $creator_installation_id"
echo "  Client ID: $creator_client_id"
echo "  Private Key: ~/.carbon6/keys/creator_$creator_installation_id"
```

---

## Phase 3: Plugin Marketplace Setup

```
ğŸ‘¤ SOVEREIGN: "The plugin marketplace requires initial configuration and seed
plugins to demonstrate functionality."

ğŸ”„ EXECUTING: Marketplace setup
```

### 3.1 Create Sample Plugins

```typescript
// scripts/seed-plugins.ts
import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

async function seedPlugins() {
  const plugins = [
    {
      name: 'Analytics Dashboard',
      description: 'Real-time analytics and reporting dashboard',
      category: 'analytics',
      version: '1.0.0',
      author: 'Carbon6 Team',
      minTier: 'CARBON',
      requiresConnector: true,
      price: 0,
      status: 'PUBLISHED',
    },
    {
      name: 'AI Content Generator',
      description: 'Generate marketing content with Council agents',
      category: 'ai',
      version: '1.0.0',
      author: 'Carbon6 Team',
      minTier: 'CARBON[6]',
      requiresConnector: true,
      price: 4900,
      status: 'PUBLISHED',
    },
    {
      name: 'Project Management Suite',
      description: 'Complete project lifecycle management',
      category: 'productivity',
      version: '1.0.0',
      author: 'Carbon6 Team',
      minTier: 'CARBON',
      requiresConnector: true,
      price: 2900,
      status: 'PUBLISHED',
    },
  ];

  for (const pluginData of plugins) {
    const plugin = await prisma.plugin.create({ data: pluginData });
    console.log(`âœ“ Plugin created: ${plugin.name} (${plugin.category})`);
  }

  console.log('âœ… SAMPLE PLUGINS CREATED');
}

seedPlugins()
  .then(() => prisma.$disconnect())
  .catch((error) => {
    console.error('âœ— Plugin seeding failed:', error);
    prisma.$disconnect();
    process.exit(1);
  });
```

**Execute:**
```bash
npx ts-node scripts/seed-plugins.ts
```

**Expected Output:**
```
âœ“ Plugin created: Analytics Dashboard (analytics)
âœ“ Plugin created: AI Content Generator (ai)
âœ“ Plugin created: Project Management Suite (productivity)

âœ… SAMPLE PLUGINS CREATED
```

---

## Phase 4: Council Agent Testing

```
ğŸ‘¤ SOVEREIGN: "Time to verify the Council's 462 agents are operational. I'll
invoke several domain specialists to confirm integration."

ğŸ”„ EXECUTING: Council agent tests
```

### 4.1 Test GENESIS Orchestrator

```bash
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "COUNCIL AGENT TESTING"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# Test 1: GENESIS Divine Orchestrator
echo "TEST 1: GENESIS Divine Orchestrator"
echo "Query: System status and readiness"
echo ""

response=$(curl -s -X POST http://localhost:3006/api/connector/agents/invoke \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $admin_api_key" \
  -d '{
    "agent_id": "GENESIS",
    "prompt": "Provide a comprehensive system status report for Carbon6 OiS",
    "clearance": "L5-BLACK"
  }')

job_id=$(echo $response | jq -r '.data.job_id')
echo "âœ“ Job created: $job_id"
echo "  Waiting for GENESIS response..."

# Poll for result (simplified)
sleep 3

result=$(curl -s http://localhost:3006/api/connector/agents/result/$job_id \
  -H "Authorization: Bearer $admin_api_key")

echo "âœ“ GENESIS Response:"
echo $result | jq -r '.data.result.output' | head -n 20
echo ""
```

### 4.2 Test Domain Specialists

```bash
# Test 2: TECHNE (Technology Specialist)
echo "TEST 2: TECHNE (Technology & Development)"
echo "Query: Analyze tech stack"
echo ""

techne_job=$(curl -s -X POST http://localhost:3006/api/connector/agents/invoke \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $admin_api_key" \
  -d '{
    "agent_id": "TECHNE",
    "prompt": "Analyze the Carbon6 tech stack and provide recommendations",
    "clearance": "L3-CONFIDENTIAL"
  }' | jq -r '.data.job_id')

echo "âœ“ TECHNE invoked: $techne_job"

# Test 3: AURUM (Finance Specialist)
echo ""
echo "TEST 3: AURUM (Finance & Treasury)"
echo "Query: Financial system setup verification"
echo ""

aurum_job=$(curl -s -X POST http://localhost:3006/api/connector/agents/invoke \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $admin_api_key" \
  -d '{
    "agent_id": "AURUM",
    "prompt": "Verify financial tracking systems are properly configured",
    "clearance": "L3-CONFIDENTIAL"
  }' | jq -r '.data.job_id')

echo "âœ“ AURUM invoked: $aurum_job"

# Test 4: AEGIS (Security Specialist)
echo ""
echo "TEST 4: AEGIS (Security Guardian)"
echo "Query: Security audit"
echo ""

aegis_job=$(curl -s -X POST http://localhost:3006/api/connector/agents/invoke \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $admin_api_key" \
  -d '{
    "agent_id": "AEGIS",
    "prompt": "Perform initial security audit of Carbon6 installation",
    "clearance": "L3-CONFIDENTIAL"
  }' | jq -r '.data.job_id')

echo "âœ“ AEGIS invoked: $aegis_job"
echo ""
echo "âœ… COUNCIL AGENTS RESPONDING"
```

---

## Phase 5: 88xâ„¢ Chairman Console Initialization

```
ğŸ‘¤ SOVEREIGN: "The 88xâ„¢ Chairman Oversight Console controls 1,000 Super Mini
Traders. Let's configure the initial state and risk parameters."

ğŸ”„ EXECUTING: 88xâ„¢ initialization
```

### 5.1 Initialize Trading System

```typescript
// scripts/init-88x.ts
import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

async function initialize88x() {
  // Create 88xâ„¢ configuration
  await prisma.systemConfig.create({
    data: {
      key: '88x_enabled',
      value: 'true',
      category: 'trading',
      description: '88xâ„¢ Trading System Enabled',
    },
  });

  // Initialize Super Mini Trader pool
  console.log('Initializing 1,000 Super Mini Traders...');

  const traders = [];
  for (let i = 1; i <= 1000; i++) {
    traders.push({
      id: `smid_${i.toString().padStart(4, '0')}`,
      name: `Super Mini ${i}`,
      status: 'READY',
      capital: 0,
      maxPositionSize: 1000,
      riskLevel: 'MODERATE',
      strategyType: i % 5 === 0 ? 'MOMENTUM' : i % 3 === 0 ? 'MEAN_REVERSION' : 'SCALPING',
      createdAt: new Date(),
    });
  }

  await prisma.superMiniTrader.createMany({ data: traders });

  console.log('âœ“ 1,000 Super Mini Traders initialized');

  // Create default risk parameters
  await prisma.riskParameters.create({
    data: {
      maxDailyLoss: 5000,
      maxPositionSize: 10000,
      maxLeverage: 3,
      stopLossPercentage: 2,
      takeProfitPercentage: 5,
      tradingHours: { start: '09:30', end: '16:00' },
      enabledMarkets: ['stocks', 'crypto', 'forex'],
    },
  });

  console.log('âœ“ Risk parameters configured');

  // Initialize dashboard state
  await prisma.dashboardState.create({
    data: {
      totalAUM: 0,
      dailyPnL: 0,
      activeTraders: 1000,
      riskLevel: 'SAFE',
      lastUpdated: new Date(),
    },
  });

  console.log('âœ“ Dashboard state initialized');
  console.log('âœ… 88xâ„¢ CHAIRMAN CONSOLE READY');
}

initialize88x()
  .then(() => prisma.$disconnect())
  .catch((error) => {
    console.error('âœ— 88xâ„¢ initialization failed:', error);
    prisma.$disconnect();
    process.exit(1);
  });
```

**Execute:**
```bash
npx ts-node scripts/init-88x.ts
```

**Expected Output:**
```
Initializing 1,000 Super Mini Traders...
âœ“ 1,000 Super Mini Traders initialized
âœ“ Risk parameters configured
âœ“ Dashboard state initialized

âœ… 88xâ„¢ CHAIRMAN CONSOLE READY
```

### 5.2 Verify Console Access

```bash
echo ""
echo "Verifying 88xâ„¢ Chairman Console..."
echo ""

# Open console in browser
open http://localhost:3006/console

# Check API endpoint
console_status=$(curl -s http://localhost:3006/api/console/status \
  -H "Authorization: Bearer $admin_api_key")

echo "Console Status:"
echo $console_status | jq '.'
```

---

## Phase 6: Monitoring & Observability

```
ğŸ‘¤ SOVEREIGN: "Production systems require comprehensive monitoring. I'll
configure health checks, metrics, and alerting."

ğŸ”„ EXECUTING: Monitoring setup
```

### 6.1 Configure Prometheus Metrics

```javascript
// src/lib/monitoring/prometheus.ts
import client from 'prom-client';

// Create registry
const register = new client.Registry();

// Default metrics (CPU, memory, etc.)
client.collectDefaultMetrics({ register });

// Custom metrics
export const httpRequestDuration = new client.Histogram({
  name: 'http_request_duration_seconds',
  help: 'Duration of HTTP requests in seconds',
  labelNames: ['method', 'route', 'status_code'],
  buckets: [0.1, 0.3, 0.5, 0.7, 1, 3, 5, 7, 10],
  registers: [register],
});

export const connectorRequests = new client.Counter({
  name: 'connector_requests_total',
  help: 'Total number of connector requests',
  labelNames: ['installation_id', 'endpoint', 'status'],
  registers: [register],
});

export const agentInvocations = new client.Counter({
  name: 'agent_invocations_total',
  help: 'Total number of Council agent invocations',
  labelNames: ['agent_id', 'status'],
  registers: [register],
});

export const activeConnections = new client.Gauge({
  name: 'active_websocket_connections',
  help: 'Number of active WebSocket connections',
  registers: [register],
});

export { register };
```

### 6.2 Create Grafana Dashboard

```yaml
# config/grafana-dashboard.json
{
  "dashboard": {
    "title": "Carbon6 OiS Operations",
    "panels": [
      {
        "title": "API Response Time",
        "targets": [
          {
            "expr": "histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m]))"
          }
        ]
      },
      {
        "title": "Connector Requests",
        "targets": [
          {
            "expr": "rate(connector_requests_total[1m])"
          }
        ]
      },
      {
        "title": "Agent Invocations",
        "targets": [
          {
            "expr": "rate(agent_invocations_total[5m])"
          }
        ]
      },
      {
        "title": "Active WebSockets",
        "targets": [
          {
            "expr": "active_websocket_connections"
          }
        ]
      }
    ]
  }
}
```

### 6.3 Configure Alerting

```yaml
# config/alerts.yml
groups:
  - name: carbon6_alerts
    interval: 30s
    rules:
      - alert: HighErrorRate
        expr: rate(http_request_duration_seconds_count{status_code=~"5.."}[5m]) > 0.01
        for: 2m
        labels:
          severity: critical
        annotations:
          summary: "High error rate detected"
          description: "Error rate is {{ $value }} requests/sec"

      - alert: HighResponseTime
        expr: histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m])) > 0.5
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "High API response time"
          description: "P95 latency is {{ $value }}s"

      - alert: DatabaseConnectionPoolFull
        expr: database_connections_active / database_connections_max > 0.8
        for: 2m
        labels:
          severity: warning
        annotations:
          summary: "Database connection pool nearly full"
          description: "{{ $value }}% of connections in use"
```

---

## Phase 7: Automated Backups

```
ğŸ‘¤ SOVEREIGN: "Data sovereignty requires backup sovereignty. I'll configure
automated daily backups with encryption and retention policies."

ğŸ”„ EXECUTING: Backup configuration
```

### 7.1 Database Backup Script

```bash
#!/bin/bash
# scripts/backup-database.sh

set -e

BACKUP_DIR="/Users/Morpheous/Carbon6/backups"
DATE=$(date +%Y%m%d_%H%M%S)
DATABASE_URL="${DATABASE_URL}"

mkdir -p "$BACKUP_DIR"

echo "Starting database backup..."
echo "Timestamp: $DATE"

# PostgreSQL backup
if [[ $DATABASE_URL == postgres* ]]; then
  pg_dump $DATABASE_URL | gzip > "$BACKUP_DIR/carbon6_db_$DATE.sql.gz"
  echo "âœ“ PostgreSQL backup created: $BACKUP_DIR/carbon6_db_$DATE.sql.gz"

# SQLite backup
elif [[ $DATABASE_URL == file* ]]; then
  db_path=$(echo $DATABASE_URL | sed 's/file://')
  cp "$db_path" "$BACKUP_DIR/carbon6_db_$DATE.db"
  gzip "$BACKUP_DIR/carbon6_db_$DATE.db"
  echo "âœ“ SQLite backup created: $BACKUP_DIR/carbon6_db_$DATE.db.gz"
fi

# Encrypt backup
openssl enc -aes-256-cbc -salt \
  -in "$BACKUP_DIR/carbon6_db_$DATE.sql.gz" \
  -out "$BACKUP_DIR/carbon6_db_$DATE.sql.gz.enc" \
  -k "$BACKUP_ENCRYPTION_KEY"

rm "$BACKUP_DIR/carbon6_db_$DATE.sql.gz"
echo "âœ“ Backup encrypted"

# Retention policy (keep last 30 days)
find "$BACKUP_DIR" -name "carbon6_db_*.enc" -mtime +30 -delete
echo "âœ“ Old backups cleaned up"

echo "âœ… BACKUP COMPLETE"
```

### 7.2 Schedule Automated Backups

```bash
# Add to crontab for daily backups at 2 AM
(crontab -l 2>/dev/null; echo "0 2 * * * /Users/Morpheous/Carbon6/platform/scripts/backup-database.sh >> /Users/Morpheous/Carbon6/logs/backup.log 2>&1") | crontab -

echo "âœ“ Daily backups scheduled (2:00 AM)"

# Also configure PM2 to run backups
pm2 install pm2-auto-pull
pm2 set pm2-auto-pull:interval 86400  # Daily
pm2 set pm2-auto-pull:repository /Users/Morpheous/Carbon6/platform

echo "âœ“ PM2 backup automation configured"
```

---

## Phase 8: Production Hardening

```
ğŸ‘¤ SOVEREIGN: "Final phase - production security hardening. This ensures
Carbon6 OiS meets L5-BLACK operational standards."

ğŸ”„ EXECUTING: Security hardening
```

### 8.1 Environment Security Audit

```bash
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "PRODUCTION SECURITY HARDENING"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# Check .env file permissions
if [ -f .env ]; then
  env_perms=$(stat -f %A .env)
  if [ "$env_perms" != "600" ]; then
    echo "âš ï¸  .env has insecure permissions: $env_perms"
    chmod 600 .env
    echo "âœ“ .env permissions fixed: 600"
  else
    echo "âœ“ .env permissions secure: 600"
  fi
fi

# Verify no secrets in git
if git check-ignore .env >/dev/null 2>&1; then
  echo "âœ“ .env properly ignored by git"
else
  echo "âš ï¸  .env not in .gitignore"
  echo ".env" >> .gitignore
  echo "âœ“ .env added to .gitignore"
fi

# Check SSH key permissions
for key in ~/.ssh/id_*; do
  if [[ $key != *.pub ]]; then
    key_perms=$(stat -f %A $key)
    if [ "$key_perms" != "600" ]; then
      chmod 600 $key
      echo "âœ“ Fixed permissions: $key"
    fi
  fi
done

echo "âœ“ SSH key permissions verified"
```

### 8.2 Configure Rate Limiting

```typescript
// src/lib/security/rate-limiter.ts
import rateLimit from 'express-rate-limit';
import RedisStore from 'rate-limit-redis';
import { redis } from '@/lib/redis';

export const apiLimiter = rateLimit({
  store: new RedisStore({
    client: redis,
    prefix: 'rl:api:',
  }),
  windowMs: 15 * 60 * 1000, // 15 minutes
  max: 100, // Limit each IP to 100 requests per window
  message: 'Too many requests from this IP, please try again later.',
  standardHeaders: true,
  legacyHeaders: false,
});

export const connectorLimiter = rateLimit({
  store: new RedisStore({
    client: redis,
    prefix: 'rl:connector:',
  }),
  windowMs: 60 * 60 * 1000, // 1 hour
  max: 1000, // Per installation
  keyGenerator: (req) => req.headers['x-client-id'] as string,
  message: 'Connector rate limit exceeded',
});

export const authLimiter = rateLimit({
  store: new RedisStore({
    client: redis,
    prefix: 'rl:auth:',
  }),
  windowMs: 15 * 60 * 1000, // 15 minutes
  max: 5, // Max 5 failed login attempts
  message: 'Too many authentication attempts',
});
```

### 8.3 Enable Security Headers

```typescript
// src/middleware/security-headers.ts
import { NextResponse } from 'next/server';
import type { NextRequest } from 'next/server';

export function securityHeaders(request: NextRequest) {
  const response = NextResponse.next();

  // Security headers
  response.headers.set('X-Frame-Options', 'DENY');
  response.headers.set('X-Content-Type-Options', 'nosniff');
  response.headers.set('X-XSS-Protection', '1; mode=block');
  response.headers.set('Referrer-Policy', 'strict-origin-when-cross-origin');
  response.headers.set(
    'Strict-Transport-Security',
    'max-age=31536000; includeSubDomains'
  );
  response.headers.set(
    'Content-Security-Policy',
    "default-src 'self'; script-src 'self' 'unsafe-eval' 'unsafe-inline'; style-src 'self' 'unsafe-inline';"
  );
  response.headers.set(
    'Permissions-Policy',
    'camera=(), microphone=(), geolocation=()'
  );

  return response;
}
```

---

## Phase 9: Operational Runbooks

```
ğŸ‘¤ SOVEREIGN: "I'll create operational runbooks for common scenarios.
Knowledge is power, and documented procedures ensure operational excellence."

ğŸ”„ EXECUTING: Runbook creation
```

### 9.1 Create Runbook Directory

```bash
mkdir -p /Users/Morpheous/Carbon6/platform/runbooks

# Create runbook templates
cat > runbooks/INCIDENT_RESPONSE.md << 'EOF'
# Incident Response Runbook

## Severity Levels

- **P0 (Critical)**: Complete system outage
- **P1 (High)**: Major functionality impaired
- **P2 (Medium)**: Minor functionality impaired
- **P3 (Low)**: Cosmetic issues

## Response Procedures

### P0: System Down
1. Check PM2 status: `pm2 status`
2. Check logs: `pm2 logs carbon6-api --lines 100`
3. Check database: `psql $DATABASE_URL -c "SELECT 1"`
4. Check Redis: `redis-cli ping`
5. Restart if needed: `pm2 restart carbon6-api`

### Database Connection Issues
1. Verify PostgreSQL running: `pg_isready`
2. Check connections: `psql -c "SELECT count(*) FROM pg_stat_activity"`
3. Restart if needed: `brew services restart postgresql@15`

### High Memory Usage
1. Check PM2 memory: `pm2 monit`
2. If > 1GB per instance, restart: `pm2 reload carbon6-api`
3. Check for memory leaks in logs

### Failed Deployments
1. Stop current: `pm2 stop carbon6-api`
2. Restore previous: `git checkout <previous-commit>`
3. Rebuild: `npm run build`
4. Restart: `pm2 start ecosystem.config.js`
EOF

cat > runbooks/BACKUP_RESTORE.md << 'EOF'
# Backup & Restore Runbook

## Restore from Backup

### PostgreSQL
```bash
# List available backups
ls -lh /Users/Morpheous/Carbon6/backups/

# Decrypt backup
openssl enc -aes-256-cbc -d \
  -in carbon6_db_20260212.sql.gz.enc \
  -out carbon6_db_20260212.sql.gz \
  -k $BACKUP_ENCRYPTION_KEY

# Decompress
gunzip carbon6_db_20260212.sql.gz

# Stop application
pm2 stop carbon6-api

# Drop and restore database
dropdb carbon6
createdb carbon6
psql carbon6 < carbon6_db_20260212.sql

# Restart application
pm2 start carbon6-api
```

### Verify Restore
```bash
psql carbon6 -c "SELECT COUNT(*) FROM creators"
psql carbon6 -c "SELECT COUNT(*) FROM projects"
```
EOF

echo "âœ“ Runbooks created in /Users/Morpheous/Carbon6/platform/runbooks/"
```

---

## Installation Complete

```
ğŸ‘¤ SOVEREIGN: "Configuration complete. Carbon6 OiS is now production-ready and
operating at L5-BLACK standards.

WHAT YOU NOW HAVE:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… ACCOUNTS & ACCESS
   â””â”€ Admin account with L5-BLACK clearance
   â””â”€ First Creator account (Carbon tier)
   â””â”€ SDK connector installation configured

âœ… MARKETPLACE
   â””â”€ Plugin marketplace initialized
   â””â”€ 3 sample plugins available
   â””â”€ Upload and distribution ready

âœ… COUNCIL INTEGRATION
   â””â”€ 462 agents verified and responding
   â””â”€ GENESIS orchestrator operational
   â””â”€ Domain specialists tested (TECHNE, AURUM, AEGIS)

âœ… 88xâ„¢ TRADING SYSTEM
   â””â”€ 1,000 Super Mini Traders initialized
   â””â”€ Chairman Console accessible
   â””â”€ Risk parameters configured

âœ… MONITORING & OBSERVABILITY
   â””â”€ Prometheus metrics configured
   â””â”€ Grafana dashboard ready
   â””â”€ Alerting rules defined

âœ… BACKUPS & DISASTER RECOVERY
   â””â”€ Daily automated backups (2:00 AM)
   â””â”€ Encryption enabled
   â””â”€ 30-day retention policy

âœ… SECURITY HARDENING
   â””â”€ Rate limiting enforced
   â””â”€ Security headers configured
   â””â”€ Environment secured
   â””â”€ Permissions verified

âœ… OPERATIONAL EXCELLENCE
   â””â”€ Incident response runbooks
   â””â”€ Backup/restore procedures
   â””â”€ Monitoring dashboards
   â””â”€ Production standards met

QUICK ACCESS URLS:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸŒ Platform:        http://localhost:3006
ğŸ–¥ï¸  Terminal:        http://localhost:3006/terminal
ğŸ“Š 88xâ„¢ Console:    http://localhost:3006/console
ğŸ’¾ Admin Dashboard: http://localhost:3006/admin
ğŸ“ˆ Metrics:         http://localhost:3006/api/metrics
ğŸ¥ Health Check:    http://localhost:3006/api/health

NEXT STEPS:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. Login to admin dashboard
2. Create your first project
3. Invite additional creators
4. Explore Council agents via terminal
5. Configure 88xâ„¢ capital deployment
6. Set up custom plugins

Your Carbon6 Operational Intelligence System is now live.
Welcome to sovereign, AI-powered operations."
```

**Status:** âœ… PRODUCTION READY

```
SOVEREIGN (Strategic Command)
Document ID: L5-INSTALL-2026-003 | Part 3 of 4
Classification: L5-BLACK | February 12, 2026
```
